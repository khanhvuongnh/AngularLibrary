<div id="media-uploader" [ngStyle]="{'height': height + 'rem'}">
  <div *ngIf="!mediaItem.type || !mediaItem.src" class="card uploader">
    <div class="card-body">
      <div class="group-container">
        <img *ngIf="height >= 10" [src]="imagePlusUrl">
        <label [for]="'browse-file-' + id" class="btn btn-primary" type="button">
          Browse Files
          <input type="file" [name]="'browse-file-' + mediaItem.id" [id]="'browse-file-' + id" [accept]="accept"
            [multiple]="false" hidden (change)="onSelectFile($event)" />
        </label>
      </div>
    </div>
  </div>

  <div *ngIf="mediaItem.type && mediaItem.src" class="card media">
    <div class="card-body">
      <img #imgSrc *ngIf="mediaItem.type === mediaType.IMG" [src]="mediaItem.src"
        (error)="imgSrc.hidden = true; errorImg.hidden = false" />

      <video #videoSrc *ngIf="mediaItem.type === mediaType.VIDEO" [src]="mediaItem.src"
        (error)="videoSrc.hidden = true; errorImg.hidden = false"></video>

      <img #errorImg [src]="imageErrorUrl" hidden>

      <div class="action-button-group">
        <button *ngIf="preview" type="button" class="btn btn-light" (click)="openModal()">
          <img [src]="imagePreviewUrl">
        </button>
        <button *ngIf="copyable" type="button" class="btn btn-light" (click)="copySrc()">
          <img [src]="imageCopyUrl">
        </button>
        <button *ngIf="crop" type="button" class="btn btn-light" (click)="openCropModal()">
          <img [src]="imageCropUrl">
        </button>
        <button *ngIf="!disabled" type="button" class="btn btn-light" (click)="onRemoveMediaClicked()">
          <img [src]="imageDeleteUrl">
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" [id]="'modal-media-' + id" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body">
        <img #imgSrcModal *ngIf="previewType === mediaType.IMG" width="100%" [src]="previewSrc" alt="Preview"
          (error)="imgSrcModal.hidden = true; errorImgModal.hidden = false">
        <video #videoSrcModal *ngIf="previewType === mediaType.VIDEO" width="100%" [src]="previewSrc" alt="Preview"
          controls (error)="videoSrcModal.hidden = true; errorImgModal.hidden = false"></video>
        <img #errorImgModal [src]="imageErrorUrl" hidden>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" [id]="'modal-crop-' + id" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body">
        <div class="row">
          <div class="col-md-9">
            <image-cropper *ngIf="cropImage.type === mediaType.IMG" [imageFile]="cropImage.file" format="png"
              [containWithinAspectRatio]="containWithinAspectRatio" (imageCropped)="imageCropped($event)"
              [maintainAspectRatio]="true" [canvasRotation]="canvasRotation" [transform]="transform"
              class="img-container">
            </image-cropper>
          </div>
          <div class="col-md-3">
            <img [src]="cropImage.src" class="img-preview" />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="btn-group" role="group">
          <button class="btn btn-light" (click)="rotateLeft()">
            <img class="img-icon" [src]="cropRotateLeftImage" alt="rotateLeft">
          </button>
          <button class="btn btn-light" (click)="rotateRight()">
            <img class="img-icon" [src]="cropRotateRightImage" alt="rotateRight">
          </button>
          <button class="btn btn-light" (click)="flipHorizontal()">
            <img class="img-icon" [src]="cropFlipHorizontalImage" alt="flipHorizontal">
          </button>
          <button class="btn btn-light" (click)="flipVertical()">
            <img class="img-icon" [src]="cropFlipVerticalImage" alt="flipVertical">
          </button>
        </div>
        <div class="btn-group" role="group">
          <button class="btn btn-light" (click)="toggleContainWithinAspectRatio()">
            <img class="img-icon" [src]="containWithinAspectRatio ? cropZoomInImage : cropZoomOutImage"
              [alt]="containWithinAspectRatio ? 'Fill Aspect Ratio' : 'Contain Within Aspect Ratio'">)</button>
          <button class="btn btn-light" (click)="resetImage()">
            <img class="img-icon" [src]="cropResetChangesImage" alt="resetImage">
          </button>
          <button class="btn btn-light" (click)="saveImage()">
            <img class="img-icon" [src]="cropEditImage" alt="saveEditChange">
          </button>
        </div>
      </div>
    </div>
  </div>
</div>